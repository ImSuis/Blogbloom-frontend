{"ast":null,"code":"// import moment from 'moment';\n// import React, { useEffect, useState } from 'react';\n// import { toast } from \"react-toastify\";\n// import { deleteCommentApi, getCommentsApi, getSingleBlogApi, postCommentApi } from '../api/Api';\n\n// const SingleBlogPost = ({ blogId, loggedInUserId }) => {\n//     const [blog, setBlog] = useState(null);\n//     const [comments, setComments] = useState([]);\n//     const [replyingTo, setReplyingTo] = useState(null); // State to track which comment is being replied to\n//     const [commenting, setCommenting] = useState(false); // State to track whether the comment text field should be displayed\n\n//     useEffect(() => {\n//         const fetchData = async () => {\n//             try {\n//                 const blogResponse = await getSingleBlogApi(blogId);\n//                 console.log('Blog Data:', blogResponse.data); // Log the blog data\n//                 setBlog(blogResponse.data.blog);\n\n//                 const commentsResponse = await getCommentsApi(blogId); // Fetch comments using the getCommentsApi function\n//                 console.log('Comments Data:', commentsResponse.data); // Log the comments data\n//                 setComments(commentsResponse.data.comments);\n//             } catch (error) {\n//                 console.error('Error fetching data:', error);\n//             }\n//         };\n\n//         fetchData();\n//     }, [blogId]);\n\n//     if (!blog) {\n//         return <div>Loading...</div>;\n//     }\n\n//     // Function to organize comments into a tree-like structure\n//     const organizeComments = (comments) => {\n//         const commentMap = new Map();\n//         const rootComments = [];\n\n//         // Map each comment to its ID\n//         comments.forEach(comment => {\n//             commentMap.set(comment._id, comment);\n//         });\n\n//         // Iterate over comments to build the tree\n//         comments.forEach(comment => {\n//             if (comment.parentComment) {\n//                 const parentComment = commentMap.get(comment.parentComment);\n//                 if (parentComment) {\n//                     if (!parentComment.replies) {\n//                         parentComment.replies = [];\n//                     }\n//                     parentComment.replies.push(comment);\n//                 }\n//             } else {\n//                 rootComments.push(comment);\n//             }\n//         });\n\n//         return rootComments;\n//     };\n\n//     // Organize comments into a tree-like structure\n//     const threadedComments = organizeComments(comments);\n\n//     // Function to handle click on the comment icon\n//     const handleCommentIconClick = () => {\n//         setCommenting(!commenting); // Toggle the commenting state\n//     };\n\n//     // Function to post a comment\n//     const handleCommentSubmit = async () => {\n//         // Get the content of the comment from the input field\n//         const commentContent = document.getElementById('commentInput').value;\n\n//         try {\n//             // Post the comment to the backend\n//             await postCommentApi(blogId, { content: commentContent });\n//             // Refresh comments after posting\n//             const commentsResponse = await getCommentsApi(blogId);\n//             setComments(commentsResponse.data.comments);\n//             // Clear the input field and hide the comment text field\n//             document.getElementById('commentInput').value = '';\n//             setCommenting(false);\n//             toast.success(\"Comment posted successfully.\");\n//         } catch (error) {\n//             console.error('Error posting comment:', error);\n//         }\n//     };\n\n//     // Function to handle submitting a reply\n//     const handleReplySubmit = async (parentCommentId, replyContent) => {\n//         try {\n//             await postCommentApi(blogId, { content: replyContent, parentComment: parentCommentId });\n//             // Refresh comments after posting\n//             const commentsResponse = await getCommentsApi(blogId);\n//             setComments(commentsResponse.data.comments);\n\n//             // Clear replyingTo state\n//             setReplyingTo(null);\n//             toast.success(\"Reply posted successfully.\");\n//         } catch (error) {\n//             toast.error(\"Error posting reply.\");\n//             console.error('Error posting reply:', error);\n//         }\n//     };\n\n//     // Function to handle deleting a comment\n//     const handleDeleteComment = async (commentId) => {\n//         try {\n//             await deleteCommentApi(commentId);\n//             // Refresh comments after deleting\n//             const commentsResponse = await getCommentsApi(blogId);\n//             setComments(commentsResponse.data.comments);\n\n//             // Show success toast message or perform any other necessary actions\n//             toast.success(\"Comment deleted successfully.\");\n//         } catch (error) {\n//             console.error('Error deleting comment:', error);\n//             // Show error toast message or perform any other necessary actions\n//             toast.error(\"You are not authorized to delete this comment.\");\n//         }\n//     };\n\n//     // Function to render threaded comments recursively\n//     const renderComments = (comments, renderedIds = new Set()) => {\n//         return (\n//             <ul className=\"list-unstyled\">\n//                 {comments.map(comment => {\n//                     if (renderedIds.has(comment._id)) {\n//                         return null; // Skip rendering if the comment is already rendered\n//                     }\n//                     renderedIds.add(comment._id); // Add comment ID to rendered set\n//                     return (\n//                         <li key={comment._id}>\n//                             <div>\n//                                 <div className=\"comment-meta\" style={{ marginBottom: '0.5em' }}>\n//                                     <p className=\"small text-muted\" style={{ fontSize: '0.9em', margin: '0' }}>\n//                                         <small>Author:</small>{' '}\n//                                         <span className=\"text-grey\" style={{ fontSize: '0.8em' }}>{`${comment.user.firstName || 'Unknown'} ${comment.user.lastName || 'Unknown'}`}</span>\n//                                     </p>\n//                                     <p className=\"small text-muted\" style={{ fontSize: '0.9em', margin: '0' }}>\n//                                         <strong>Date:</strong>{' '}\n//                                         <span className=\"text-grey\" style={{ fontSize: '0.8em' }}>{moment(comment.createdAt).format('MMMM Do YYYY, h:mm a')}</span>\n//                                     </p>\n//                                 </div>\n//                                 <p>{comment.content}</p>\n//                                 <div className=\"action-icons\" style={{ marginTop: '-1em' }}>\n//                                     {(comment.user.id === loggedInUserId || loggedInUserId === 'admin') && ( // Check if the logged-in user is the author of the comment or is an admin\n//                                         <i className=\"bi bi-trash-fill\" onClick={() => handleDeleteComment(comment._id)}></i> // Delete icon with onClick event\n//                                     )}\n//                                     <i className=\"bi bi-reply-fill\" onClick={() => setReplyingTo(comment._id)}></i> {/* Bootstrap reply icon */}\n//                                 </div>\n//                                 {replyingTo === comment._id && ( // Conditional rendering for reply text field\n//                                     <div className=\"reply-text-field\">\n//                                         <div className=\"input-group mb-3\">\n//                                             <input id=\"replyInput\" type=\"text\" className=\"form-control\" placeholder=\"Write a reply...\" style={{ width: 'calc(100% - 42px)', marginBottom: '0.5em' }} />\n//                                             <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'white', color: 'black', borderRadius: '35px', marginBottom: '0.5em' }} onClick={() => setReplyingTo(null)}>Cancel</button>\n//                                             <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'black', color: 'white', borderRadius: '35px', marginBottom: '0.5em' }} onClick={() => handleReplySubmit(comment._id, document.getElementById('replyInput').value)}>Reply</button>\n//                                         </div>\n//                                     </div>\n//                                 )}\n//                             </div>\n//                             {comment.replies && <ul>{renderComments(comment.replies, renderedIds)}</ul>} {/* Render replies recursively */}\n//                         </li>\n//                     );\n//                 })}\n//             </ul>\n//         );\n//     };\n\n//     return (\n//         <div className=\"container\">\n//             <div className=\"row\">\n//                 <div className=\"col-md-10 offset-md-1\">\n//                     <h2>{blog.title}</h2>\n//                     <p className=\"small text-muted mb-2\">\n//                         <strong>Author:</strong>{' '}\n//                         <span className=\"text-grey\">{`${blog.user.firstName || 'Unknown'} ${blog.user.lastName || 'Unknown'}`}</span>\n//                     </p>\n//                     <p className=\"small text-muted mb-4\">\n//                         <strong>Date:</strong>{' '}\n//                         <span className=\"text-grey\">{moment(blog.createdAt).format('MMMM Do YYYY, h:mm a')}</span>\n//                     </p>\n//                 </div>\n//             </div>\n//             <div className=\"row\">\n//                 <div className=\"col-md-10 offset-md-1\">\n//                     <img\n//                         src={blog.blogImageUrl || 'https://via.placeholder.com/600x400'}\n//                         alt={blog.title}\n//                         className=\"img-fluid mb-4\"\n//                     />\n//                     <p style={{ whiteSpace: 'pre-wrap' }}>{blog.content}</p>\n//                     <div className=\"comment-icon\" style={{ textAlign: 'left', marginTop: '1em' }} onClick={handleCommentIconClick}>\n//                         <i className=\"bi bi-chat-square-dots\"></i> {/* Bootstrap comment icon */}\n//                     </div>\n//                     {commenting && ( // Conditional rendering for the comment text field\n//                         <div className=\"comment-text-field\">\n//                             <div className=\"input-group mb-3\">\n//                                 <input id=\"commentInput\" type=\"text\" className=\"form-control\" placeholder=\"Write a comment...\" style={{ width: 'calc(100% - 42px)', marginBottom: '0.5em' }} />\n//                                 <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'white', color: 'black', borderRadius: '35px', marginBottom: '0.5em' }} onClick={() => setCommenting(false)}>Cancel</button>\n//                                 <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'black', color: 'white', borderRadius: '35px', marginBottom: '0.5em' }} onClick={handleCommentSubmit}>Comment</button>\n//                             </div>\n//                         </div>\n//                     )}\n//                 </div>\n//             </div>\n//             <div className=\"row\">\n//                 <div className=\"col-md-10 offset-md-1\">\n//                     <h4 className=\"mt-5\">Comments:</h4>\n//                     {renderComments(threadedComments)}\n//                 </div>\n//             </div>\n//         </div>\n//     );\n// };\n\n// export default SingleBlogPost;","map":{"version":3,"names":[],"sources":["/Users/suyash/frontend-31a-ImSuis/src/components/SingleBlogPost.jsx"],"sourcesContent":["// import moment from 'moment';\n// import React, { useEffect, useState } from 'react';\n// import { toast } from \"react-toastify\";\n// import { deleteCommentApi, getCommentsApi, getSingleBlogApi, postCommentApi } from '../api/Api';\n\n// const SingleBlogPost = ({ blogId, loggedInUserId }) => {\n//     const [blog, setBlog] = useState(null);\n//     const [comments, setComments] = useState([]);\n//     const [replyingTo, setReplyingTo] = useState(null); // State to track which comment is being replied to\n//     const [commenting, setCommenting] = useState(false); // State to track whether the comment text field should be displayed\n\n//     useEffect(() => {\n//         const fetchData = async () => {\n//             try {\n//                 const blogResponse = await getSingleBlogApi(blogId);\n//                 console.log('Blog Data:', blogResponse.data); // Log the blog data\n//                 setBlog(blogResponse.data.blog);\n\n//                 const commentsResponse = await getCommentsApi(blogId); // Fetch comments using the getCommentsApi function\n//                 console.log('Comments Data:', commentsResponse.data); // Log the comments data\n//                 setComments(commentsResponse.data.comments);\n//             } catch (error) {\n//                 console.error('Error fetching data:', error);\n//             }\n//         };\n\n//         fetchData();\n//     }, [blogId]);\n\n//     if (!blog) {\n//         return <div>Loading...</div>;\n//     }\n\n//     // Function to organize comments into a tree-like structure\n//     const organizeComments = (comments) => {\n//         const commentMap = new Map();\n//         const rootComments = [];\n\n//         // Map each comment to its ID\n//         comments.forEach(comment => {\n//             commentMap.set(comment._id, comment);\n//         });\n\n//         // Iterate over comments to build the tree\n//         comments.forEach(comment => {\n//             if (comment.parentComment) {\n//                 const parentComment = commentMap.get(comment.parentComment);\n//                 if (parentComment) {\n//                     if (!parentComment.replies) {\n//                         parentComment.replies = [];\n//                     }\n//                     parentComment.replies.push(comment);\n//                 }\n//             } else {\n//                 rootComments.push(comment);\n//             }\n//         });\n\n//         return rootComments;\n//     };\n\n//     // Organize comments into a tree-like structure\n//     const threadedComments = organizeComments(comments);\n\n//     // Function to handle click on the comment icon\n//     const handleCommentIconClick = () => {\n//         setCommenting(!commenting); // Toggle the commenting state\n//     };\n\n//     // Function to post a comment\n//     const handleCommentSubmit = async () => {\n//         // Get the content of the comment from the input field\n//         const commentContent = document.getElementById('commentInput').value;\n\n//         try {\n//             // Post the comment to the backend\n//             await postCommentApi(blogId, { content: commentContent });\n//             // Refresh comments after posting\n//             const commentsResponse = await getCommentsApi(blogId);\n//             setComments(commentsResponse.data.comments);\n//             // Clear the input field and hide the comment text field\n//             document.getElementById('commentInput').value = '';\n//             setCommenting(false);\n//             toast.success(\"Comment posted successfully.\");\n//         } catch (error) {\n//             console.error('Error posting comment:', error);\n//         }\n//     };\n\n//     // Function to handle submitting a reply\n//     const handleReplySubmit = async (parentCommentId, replyContent) => {\n//         try {\n//             await postCommentApi(blogId, { content: replyContent, parentComment: parentCommentId });\n//             // Refresh comments after posting\n//             const commentsResponse = await getCommentsApi(blogId);\n//             setComments(commentsResponse.data.comments);\n\n//             // Clear replyingTo state\n//             setReplyingTo(null);\n//             toast.success(\"Reply posted successfully.\");\n//         } catch (error) {\n//             toast.error(\"Error posting reply.\");\n//             console.error('Error posting reply:', error);\n//         }\n//     };\n\n//     // Function to handle deleting a comment\n//     const handleDeleteComment = async (commentId) => {\n//         try {\n//             await deleteCommentApi(commentId);\n//             // Refresh comments after deleting\n//             const commentsResponse = await getCommentsApi(blogId);\n//             setComments(commentsResponse.data.comments);\n\n//             // Show success toast message or perform any other necessary actions\n//             toast.success(\"Comment deleted successfully.\");\n//         } catch (error) {\n//             console.error('Error deleting comment:', error);\n//             // Show error toast message or perform any other necessary actions\n//             toast.error(\"You are not authorized to delete this comment.\");\n//         }\n//     };\n\n//     // Function to render threaded comments recursively\n//     const renderComments = (comments, renderedIds = new Set()) => {\n//         return (\n//             <ul className=\"list-unstyled\">\n//                 {comments.map(comment => {\n//                     if (renderedIds.has(comment._id)) {\n//                         return null; // Skip rendering if the comment is already rendered\n//                     }\n//                     renderedIds.add(comment._id); // Add comment ID to rendered set\n//                     return (\n//                         <li key={comment._id}>\n//                             <div>\n//                                 <div className=\"comment-meta\" style={{ marginBottom: '0.5em' }}>\n//                                     <p className=\"small text-muted\" style={{ fontSize: '0.9em', margin: '0' }}>\n//                                         <small>Author:</small>{' '}\n//                                         <span className=\"text-grey\" style={{ fontSize: '0.8em' }}>{`${comment.user.firstName || 'Unknown'} ${comment.user.lastName || 'Unknown'}`}</span>\n//                                     </p>\n//                                     <p className=\"small text-muted\" style={{ fontSize: '0.9em', margin: '0' }}>\n//                                         <strong>Date:</strong>{' '}\n//                                         <span className=\"text-grey\" style={{ fontSize: '0.8em' }}>{moment(comment.createdAt).format('MMMM Do YYYY, h:mm a')}</span>\n//                                     </p>\n//                                 </div>\n//                                 <p>{comment.content}</p>\n//                                 <div className=\"action-icons\" style={{ marginTop: '-1em' }}>\n//                                     {(comment.user.id === loggedInUserId || loggedInUserId === 'admin') && ( // Check if the logged-in user is the author of the comment or is an admin\n//                                         <i className=\"bi bi-trash-fill\" onClick={() => handleDeleteComment(comment._id)}></i> // Delete icon with onClick event\n//                                     )}\n//                                     <i className=\"bi bi-reply-fill\" onClick={() => setReplyingTo(comment._id)}></i> {/* Bootstrap reply icon */}\n//                                 </div>\n//                                 {replyingTo === comment._id && ( // Conditional rendering for reply text field\n//                                     <div className=\"reply-text-field\">\n//                                         <div className=\"input-group mb-3\">\n//                                             <input id=\"replyInput\" type=\"text\" className=\"form-control\" placeholder=\"Write a reply...\" style={{ width: 'calc(100% - 42px)', marginBottom: '0.5em' }} />\n//                                             <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'white', color: 'black', borderRadius: '35px', marginBottom: '0.5em' }} onClick={() => setReplyingTo(null)}>Cancel</button>\n//                                             <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'black', color: 'white', borderRadius: '35px', marginBottom: '0.5em' }} onClick={() => handleReplySubmit(comment._id, document.getElementById('replyInput').value)}>Reply</button>\n//                                         </div>\n//                                     </div>\n//                                 )}\n//                             </div>\n//                             {comment.replies && <ul>{renderComments(comment.replies, renderedIds)}</ul>} {/* Render replies recursively */}\n//                         </li>\n//                     );\n//                 })}\n//             </ul>\n//         );\n//     };\n\n//     return (\n//         <div className=\"container\">\n//             <div className=\"row\">\n//                 <div className=\"col-md-10 offset-md-1\">\n//                     <h2>{blog.title}</h2>\n//                     <p className=\"small text-muted mb-2\">\n//                         <strong>Author:</strong>{' '}\n//                         <span className=\"text-grey\">{`${blog.user.firstName || 'Unknown'} ${blog.user.lastName || 'Unknown'}`}</span>\n//                     </p>\n//                     <p className=\"small text-muted mb-4\">\n//                         <strong>Date:</strong>{' '}\n//                         <span className=\"text-grey\">{moment(blog.createdAt).format('MMMM Do YYYY, h:mm a')}</span>\n//                     </p>\n//                 </div>\n//             </div>\n//             <div className=\"row\">\n//                 <div className=\"col-md-10 offset-md-1\">\n//                     <img\n//                         src={blog.blogImageUrl || 'https://via.placeholder.com/600x400'}\n//                         alt={blog.title}\n//                         className=\"img-fluid mb-4\"\n//                     />\n//                     <p style={{ whiteSpace: 'pre-wrap' }}>{blog.content}</p>\n//                     <div className=\"comment-icon\" style={{ textAlign: 'left', marginTop: '1em' }} onClick={handleCommentIconClick}>\n//                         <i className=\"bi bi-chat-square-dots\"></i> {/* Bootstrap comment icon */}\n//                     </div>\n//                     {commenting && ( // Conditional rendering for the comment text field\n//                         <div className=\"comment-text-field\">\n//                             <div className=\"input-group mb-3\">\n//                                 <input id=\"commentInput\" type=\"text\" className=\"form-control\" placeholder=\"Write a comment...\" style={{ width: 'calc(100% - 42px)', marginBottom: '0.5em' }} />\n//                                 <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'white', color: 'black', borderRadius: '35px', marginBottom: '0.5em' }} onClick={() => setCommenting(false)}>Cancel</button>\n//                                 <button className=\"btn btn-outline-dark me-2\" type=\"button\" style={{ backgroundColor: 'black', color: 'white', borderRadius: '35px', marginBottom: '0.5em' }} onClick={handleCommentSubmit}>Comment</button>\n//                             </div>\n//                         </div>\n//                     )}\n//                 </div>\n//             </div>\n//             <div className=\"row\">\n//                 <div className=\"col-md-10 offset-md-1\">\n//                     <h4 className=\"mt-5\">Comments:</h4>\n//                     {renderComments(threadedComments)}\n//                 </div>\n//             </div>\n//         </div>\n//     );\n// };\n\n// export default SingleBlogPost;\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}